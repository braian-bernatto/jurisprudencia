import Head from 'next/head'
import { useContext, useEffect } from 'react'
import appContext from '../context/app/appContext'
import Entidad from '../components/Entidad'
import Filtro from '../components/Filtro'
import Footer from '../components/Footer'
import Header from '../components/Header'
import Listado from '../components/Listado'
import Selected from '../components/Selected'
import PdfDocument from '../components/PdfDocument'
import ModalEntidad from '../components/ModalEntidad'

export default function Home() {
  // extraer state de aplicacion
  const AppContext = useContext(appContext)
  const {
    modalPdf,
    modalEntidad,
    entidadSelected,
    tsje,
    tribunal,
    juzgado,
    openModalEntidad,
    openModalPdf,
    selectEntidad,
    entidadesHandler,
    getResoluciones
  } = AppContext

  useEffect(() => {
    getResoluciones()
    entidadesHandler({
      type: 'TSJE',
      data: {
        entidadNombre: 'TSJE',
        miembros: [
          { nombre: 'Hugo Caceres', cargo: 'Presidente' },
          { nombre: 'Fernando Chavez', cargo: 'Vicepresidente' },
          { nombre: 'Denis Caceres', cargo: 'Vocal' }
        ]
      }
    })
    entidadesHandler({
      type: 'TRIBUNAL',
      data: {
        entidadNombre: 'TRIBUNAL ELECTORAL',
        miembros: []
      }
    })
    entidadesHandler({
      type: 'JUZGADO',
      data: {
        entidadNombre: 'JUZGADO',
        miembros: []
      }
    })
  }, [])

  return (
    <div className='container mx-auto'>
      <Head>
        <title>Jurisprudencias | TSJE</title>
        <meta
          name='app de seguimiento de jurisprudencias del tsje'
          content='Generated by create next app'
        />
        <link rel='icon' href='/favicon.ico' />
      </Head>
      <Header />
      <main className='flex flex-col w-full justify-center items-center mt-10 gap-4'>
        <div className='flex flex-wrap gap-4 justify-center items-center relative'>
          <ul className='flex flex-wrap gap-4 justify-center relative'>
            <li
              key={1}
              className={`relative ${
                entidadSelected === 'TSJE' ? 'selected' : ''
              }`}
            >
              <label className='flex justify-center'>
                <input
                  className='hidden'
                  type='radio'
                  value='TSJE'
                  name='entidad'
                  onClick={e =>
                    selectEntidad(
                      e.target.value === entidadSelected ? '' : e.target.value
                    )
                  }
                />
                {tsje && <Entidad datos={tsje} />}
                {entidadSelected === 'TSJE' ? <Selected /> : ''}
              </label>
            </li>
            <li
              key={2}
              className={`relative ${
                entidadSelected === 'TRIBUNAL ELECTORAL' ? 'selected' : ''
              }`}
            >
              <label className='flex justify-center'>
                <input
                  className='hidden'
                  type='radio'
                  value='TRIBUNAL ELECTORAL'
                  name='entidad'
                  onClick={e => {
                    selectEntidad(
                      e.target.value === entidadSelected ? '' : e.target.value
                    )
                    e.target.value === entidadSelected
                      ? entidadesHandler({
                          type: 'TRIBUNAL',
                          data: {
                            entidadNombre: 'TRIBUNAL ELECTORAL',
                            miembros: []
                          }
                        })
                      : openModalEntidad(!modalEntidad)
                  }}
                />
                {tribunal && <Entidad datos={tribunal} />}
                {entidadSelected === 'TRIBUNAL ELECTORAL' ? <Selected /> : ''}
              </label>
            </li>
            <li
              key={3}
              className={`relative ${
                entidadSelected === 'JUZGADO' ? 'selected' : ''
              }`}
            >
              <label className='flex justify-center'>
                <input
                  className='hidden'
                  type='radio'
                  value='JUZGADO'
                  name='entidad'
                  onClick={e => {
                    selectEntidad(
                      e.target.value === entidadSelected ? '' : e.target.value
                    )
                    e.target.value === entidadSelected
                      ? entidadesHandler({
                          type: 'JUZGADO',
                          data: {
                            entidadNombre: 'JUZGADO',
                            miembros: []
                          }
                        })
                      : openModalEntidad(!modalEntidad)
                  }}
                />
                {juzgado && <Entidad datos={juzgado} />}
                {entidadSelected === 'JUZGADO' ? <Selected /> : ''}
              </label>
            </li>
          </ul>
          {modalEntidad && entidadSelected === 'TRIBUNAL ELECTORAL' && (
            <ModalEntidad
              data={[
                {
                  type: 'TRIBUNAL',
                  data: {
                    entidadNombre: 'Tribunal Electoral Capital y Central',
                    miembros: [
                      { nombre: 'Hugo Caceres', cargo: 'Presidente' },
                      {
                        nombre: 'Fernando Chavez',
                        cargo: 'Vicepresidente'
                      },
                      { nombre: 'Denis Caceres', cargo: 'Vocal' }
                    ]
                  }
                },
                {
                  type: 'TRIBUNAL',
                  data: {
                    entidadNombre:
                      'Tribunal Electoral de Paraguarí, Cordillera, Pdte. Hayes y Boquerón',
                    miembros: [
                      { nombre: 'Diego Caceres', cargo: 'Presidente' },
                      { nombre: 'Denis Chavez', cargo: 'Vicepresidente' },
                      { nombre: 'Kathy Caceres', cargo: 'Vocal' }
                    ]
                  }
                }
              ]}
            />
          )}
          {modalEntidad && entidadSelected === 'JUZGADO' && (
            <ModalEntidad
              data={[
                {
                  type: 'JUZGADO',
                  data: {
                    entidadNombre: 'Juzgado de Concepción y Alto Paraguay',
                    miembros: [{ nombre: 'Luis Chaco', cargo: 'Juez' }]
                  }
                }
              ]}
            />
          )}
        </div>
        <Filtro />
        <div className='w-full flex justify-center px-5 sm:px-0'>
          <Listado />
        </div>
      </main>
      {modalPdf && <PdfDocument />}
      <Footer />
    </div>
  )
}
